<app-page-form
  class="centro-operativo-page"
  module="Entidades"
  submodule="Centros Operativos"
  viewTitle="{{ isEdit ? 'Edición' : isShow ? 'Ver' : 'Nuevo'}}"
  [class.page-form-show]="isShow"
  [formGroup]="form"
  [isShow]="isShow"
  (backClick)="back($event)"
  (submitEvent)="submit(false)"
>
  <mat-accordion>
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Información principal
        </mat-panel-title>
      </mat-expansion-panel-header>
      <div class="row page-form-row">
        <mat-form-field class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
          <mat-label>Nombre</mat-label>
          <input matInput formControlName="nombre" />
          <mat-error *ngIf="form.controls['nombre'].hasError('required')">
            El nombre es <strong>requerido</strong>
          </mat-error>
        </mat-form-field>
        <mat-form-field class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
          <mat-label>Nombre Corto</mat-label>
          <input matInput formControlName="nombre_corto" />
          <mat-error *ngIf="form.controls['nombre_corto'].hasError('required')">
            El nombre corto es <strong>requerido</strong>
          </mat-error>
        </mat-form-field>
        <mat-form-field class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
          <mat-label>Clasificación</mat-label>
          <mat-select formControlName="clasificacion_id">
            <ng-container *ngFor="let o of centroOperativoClasificacionList$ | async">
              <mat-option [value]="o.id">{{o.nombre}}</mat-option>
            </ng-container>
          </mat-select>
          <mat-error *ngIf="form.controls['clasificacion_id'].hasError('required')">
            La clasificación es <strong>requerida</strong>
          </mat-error>
        </mat-form-field>
        <mat-form-field class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
          <mat-label>Alias</mat-label>
          <input matInput formControlName="alias" />
          <mat-error *ngIf="form.controls['alias'].hasError('required')">
            El alias es <strong>requerido</strong>
          </mat-error>
        </mat-form-field>
      </div>

      <div class="row page-form-row">
        <div class="row col-xs-12 col-sm-6 pr-0">
          <div class="col-xs-12" *ngIf="isShow && logo"><strong>Logo</strong></div>
          <div class="col-xs-12 logo-image-container">
            <img *ngIf="file" [src]="file | imageFileBase64 | async" alt="" class="logo-image" />
            <img *ngIf="logo" [src]="logo" alt="" class="logo-image" />
          </div>
          <input
            id="file-input"
            #fileInput
            type="file"
            accept="images/*"
            (change)="fileChange($event)"
            style="display: none"
          />
          <mat-form-field class="logo-form-field pr-0" *ngIf="!isShow">
            <mat-label>Logo</mat-label>
            <input matInput readonly formControlName="logo" (click)="fileInput.click()"/>
            <button
              type="button"
              color="primary"
              matSuffix
              mat-icon-button
              (click)="fileInput.click()"
            >
              <mat-icon>attach_file</mat-icon>
            </button>
            <mat-error *ngIf="fileControl.hasError('required')">
              El logo es <strong>requerido</strong>
            </mat-error>
          </mat-form-field>
        </div>
      </div>
    </mat-expansion-panel>

    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Libreta de Contactos
        </mat-panel-title>
      </mat-expansion-panel-header>
      <app-centros-operativos-form-contactos
        [form]="form"
        [isShow]="isShow"
        [contactoList]="contactoList"
      ></app-centros-operativos-form-contactos>
    </mat-expansion-panel>

    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Geolocalización
        </mat-panel-title>
      </mat-expansion-panel-header>
      <div class="row page-form-row">
        <mat-form-field class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
          <mat-label>País</mat-label>
          <mat-select formControlName="pais_id" id="pais-select">
            <ng-container *ngFor="let o of paisList$ | async">
              <mat-option [value]="o.id">{{o.nombre}}</mat-option>
            </ng-container>
          </mat-select>
          <mat-error *ngIf="form.controls['pais_id'].hasError('required')">
            El pais es <strong>requerido</strong>
          </mat-error>
        </mat-form-field>
        <mat-form-field class="col-xs-12 col-sm-6 col-md-4 col-lg-3" [hidden]="!paisControl.value">
          <mat-label>Localidad</mat-label>
          <mat-select formControlName="localidad_id" id="localidad-select">
            <ng-container *ngFor="let o of localidadList">
              <mat-option [value]="o.id">{{o.nombre}}</mat-option>
            </ng-container>
          </mat-select>
          <mat-error *ngIf="form.controls['localidad_id'].hasError('required')">
            La localidad es <strong>requerida</strong>
          </mat-error>
        </mat-form-field>
        <mat-form-field class="col-xs-12 col-sm-6 col-md-4 col-lg-3" *ngIf="localidadControl.value">
          <mat-label>Ciudad</mat-label>
          <mat-select formControlName="ciudad_id">
            <ng-container *ngFor="let o of ciudadList">
              <mat-option [value]="o.id">{{o.nombre}}</mat-option>
            </ng-container>
          </mat-select>
          <mat-error *ngIf="form.controls['ciudad_id'].hasError('required')">
            La dirección es <strong>requerida</strong>
          </mat-error>
        </mat-form-field>
        <mat-form-field class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
          <mat-label>Dirección</mat-label>
          <input matInput formControlName="direccion" />
          <mat-error *ngIf="form.controls['direccion'].hasError('required')">
            La dirección es <strong>requerida</strong>
          </mat-error>
        </mat-form-field>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
</app-page-form>
