<app-page-form
  class="centro-operativo-page"
  module="{{ isEdit ? 'EDITAR' : isShow ? 'VER' : 'NUEVO' }}"
  submodule="CENTRO OPERATIVO"
  [class.page-form-show]="isShow"
  [formGroup]="form"
  [hasChange]="hasChange"
  [isShow]="isShow"
  [modelo]="modelo"
  (backClick)="back($event)"
  (editClick)="redirectToEdit()"
  (submitEvent)="submit(false)"
>
  <div class="page-form-container" (keydown.enter)="onEnter($event)"><!-- Colocar siempre el onEnter -->

    <div class="section">
      <h2>INFORMACIÓN PRINCIPAL</h2>

      <div class="row" formGroupName="info" style="margin: 0;">

        <div class="col-xs-12 col-md-10">

          <div class="row">

            <div class="input-form-full col-xs-12 col-sm-6 col-md-4">
              <mat-label class="custom-label">
                <span class="required">(*) </span>
                Centro Operativo
              </mat-label>
              <mat-form-field floatLabel="always" appearance="outline" [ngClass]="{'view-mode': isShow}">
                <input matInput formControlName="nombre"  />
                <mat-error *ngIf="info.controls['nombre'].hasError('required')">
                  El nombre es <strong>requerido</strong>
                </mat-error>
              </mat-form-field>
            </div>

            <div class="input-form-full col-xs-12 col-sm-6 col-md-3">
              <mat-label class="custom-label">
                Nombre de Fantasía
              </mat-label>
              <mat-form-field floatLabel="always" appearance="outline" [ngClass]="{'view-mode': isShow}">
                <input matInput formControlName="nombre_corto" />

              </mat-form-field>
            </div>

            <div class="input-form-full col-xs-12 col-sm-6 col-md-3">
              <mat-label class="custom-label">
                <span class="required">(*) </span>
                Clasificación
              </mat-label>
              <mat-form-field floatLabel="always" appearance="outline" >
                <mat-select formControlName="clasificacion_id">
                  <ng-container *ngFor="let o of centroOperativoClasificacionList$ | async">
                    <mat-option [value]="o.id">{{ o.nombre }}</mat-option>
                  </ng-container>
                </mat-select>
                <mat-error *ngIf="info.controls['clasificacion_id'].hasError('required')">
                  La clasificación es <strong>requerida</strong>
                </mat-error>
              </mat-form-field>
            </div>

            <div class="input-form-full col-xs-12 col-sm-6 col-md-2" style="display: flex; align-items: center;">
              <mat-slide-toggle formControlName="estado" >
                {{ estadoControlValue ? "Activo" : "No activo" }}
              </mat-slide-toggle>
            </div>

            <div class="input-form-full col-xs-12 col-sm-6 col-md-3">
              <mat-label>Web</mat-label>
              <mat-form-field floatLabel="always" appearance="outline"
                  [ngClass]="{'view-mode': isShow}">
                <input matInput formControlName="pagina_web" [readonly]="isShow" />
              </mat-form-field>
            </div>

            <div class="input-form-full col-xs-12 col-sm-6 col-md-3">
              <mat-label >Comentario</mat-label>
              <mat-form-field floatLabel="always" appearance="outline">
                <input matInput formControlName="comentario" />
              </mat-form-field>
            </div>

            <div class="input-form-full col-xs-12 col-sm-6 col-md-4">
              <mat-label class="custom-label">
                <span class="required">(*) </span>
                Origen/Destino
              </mat-label>

              <mat-radio-group
                formControlName="origen_destino"
                style="display: flex; gap: 12px; margin-top: 4px;"
              >
                <mat-radio-button value="ORIGEN">Origen</mat-radio-button>
                <mat-radio-button value="DESTINO">Destino</mat-radio-button>
                <mat-radio-button value="ORIGEN|DESTINO">Ambos</mat-radio-button>
              </mat-radio-group>

                <mat-error *ngIf="
                info.controls['origen_destino'].hasError('required') &&
                (info.controls['origen_destino'].touched || formSubmitted)
              ">
                Este campo es <strong>requerido</strong>
              </mat-error>

            </div>

          </div>

        </div>

        <app-file-field
          class="input-form-full col-xs-12 col-md-2"
          title="Foto"
          groupName="info"
          controlName="logo"
          [field]="logo"
          [form]="form"
          [isEdit]="isEdit"
          (fileChange)="fileChange($event)"
        ></app-file-field>

      </div>
    </div>

    <div class="section geolocation-section">
      <h2>GEOLOCALIZACIÓN</h2>
      <div formGroupName="geo">
        <app-page-form-geo
        [ciudadSelected]="ciudadSelected"
        [form]="form"
        [isShow]="isShow"
        [isPanelOpen]="true"
      ></app-page-form-geo>

      </div>
    </div>

    <div class="section contactos-section" *ngIf="user?.gestor_carga_id && (modelo | puede: a.MODIFICAR_CONTACTOS)">
      <h2 class="contactos-heading">CONTACTOS</h2>
      <app-page-form-contactos
        [form]="form"
        [isShow]="isShow"
        [contactoList]="contactoList"
      ></app-page-form-contactos>
    </div>

  </div>
</app-page-form>
